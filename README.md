# Code reposity for Danielle Paulson's Harvard College Senior Thesis "Leveraging Sparsity for Multi-Parameter Inference in the Gaussian Linear Model"

This repository contains the source code for implementing all of the testing procedures and reproducing all of the figures presented in the thesis. The L-test, a multivariate extension of the work in https://arxiv.org/abs/2406.18390, is a LASSO-based method for testing the significance of a subset of parameters of interest in the Gaussian linear model with n < d. It has higher power than the classic F-test when the true parameter vector is sparse while providing the same validity guarantees under the exact same assumptions. Because it uses a Monte Carlo p-value that requires resampling and running the group LASSO numerous times, it is computationally intensive to perform. For this reason, we also proposed a family of alternative tests called recentered F-tests that approximate the L-test while being significantly more computationally efficient. The source code includes implementations of both the L-test and recentered F-tests.

## Methods Implementation
The file `tests.py` contains the source code for implementing the L-test and its modifications when alternative LASSO-based estimates are used (ie. standard LASSO, elastic net, sparse group LASSO), the recentered F-tests, and the oracle-test. 

## Reproducing Figures
The folder `reproducibility` contains the code for reproducing all of the experiments. Some of these were run on a single computer while others were run on a computing cluster with a Slurm manager. For these instances, we provide the scripts needed for submitting numerous jobs to the cluster in `reproducibility/scripts`. Note that a user may need to update these scripts depending on the file locations, partition names, etc. Below, we specify how to use the files in the `reproducibility` folder to generate each of the figures.
1. Power plots: Figures 4.1.1, 4.1.2, 5.5.1, and 5.5.2. Submit N jobs to the cluster with `sbatch --array=1-N run_tests.sh` to run the file `power_analysis.py` a total of N times, where N corresponds to the number of simulations. To combine the simulation results and compute the average powers, run the file `combine_sims.py` with the command `sbatch run_combine.sh.` This generates a `test_powers.pkl` file that stores the average powers of the tests. To generate the power plots, run the file `viz_powers.py` in the same directory where the `test_powers.pkl` file is stored. The `power_analysis.py` file has to be modified to generate each of the figures. For Figure 4.1.2, the `low-dimensional model setting` code block should be commented out, for Figure 5.5.1, the `high-dimensional model setting` code block should be commented out, and for Figure 5.5.2, the `large model setting` code block should be commented out. For Figure 4.1.1, the `low-dimensional model setting` code block should be commented out and the recentered F-tests that are called inside the `power` function should be swapped out for the standard LASSO test, elastic net test, and sparse group LASSO test implemented in the `tests.py` file.
2. Heat maps: Figure 4.1.3.
3. Efficiency tables: For Tables 4.2.1 and 4.2.2,
4. Robustness plots: For Figures 5.5.5, 5.5.6, 5.5.7, and 5.5.8 . The panels in Figure 4.3.1 are taken from those in the aforementioned figures.
5. HIV analysis: For Figures 4.4.1 and 5.5.9, 
6. Penalty tuning:
7. Visualizing fcn g: Figures 5.5.3 and 5.5.4. For the left panels of Figures 5.5.3 and 5.5.4, run files `viz_g_dim=2.py` and `viz_g_dim=3.py`, respectively. For the right panels corresponding to the high-dimensional setting, make the adjustments in the comments and run the same files.
